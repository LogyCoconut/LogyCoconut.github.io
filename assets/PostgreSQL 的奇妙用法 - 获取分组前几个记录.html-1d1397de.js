import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,f as p}from"./app-c91d02ba.js";const e={},t=p(`<h3 id="背景" tabindex="-1"><a class="header-anchor" href="#背景" aria-hidden="true">#</a> 背景</h3><p>在以某列为 group 条件分组下获取随机个记录</p><h3 id="数据构造" tabindex="-1"><a class="header-anchor" href="#数据构造" aria-hidden="true">#</a> 数据构造</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> class_teacher_info  
<span class="token punctuation">(</span>  
    id <span class="token keyword">serial</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>  
    class_id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>  
    teacher_id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span>  
<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">insert</span> <span class="token keyword">into</span> class_teacher_info <span class="token punctuation">(</span>class_id<span class="token punctuation">,</span> teacher_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="获取分组前-n-个记录" tabindex="-1"><a class="header-anchor" href="#获取分组前-n-个记录" aria-hidden="true">#</a> 获取分组前 n 个记录</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> class_id<span class="token punctuation">,</span> teacher_id  
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> class_id<span class="token punctuation">,</span>  
             teacher_id<span class="token punctuation">,</span>  
             ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> class_id <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> RANDOM<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rn  
      <span class="token keyword">FROM</span> class_teacher_info  
      <span class="token keyword">WHERE</span> class_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> t  
<span class="token keyword">WHERE</span> rn <span class="token operator">&lt;=</span> <span class="token number">3</span>  
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> class_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),o=[t];function c(l,i){return s(),a("div",null,o)}const r=n(e,[["render",c],["__file","PostgreSQL 的奇妙用法 - 获取分组前几个记录.html.vue"]]);export{r as default};
